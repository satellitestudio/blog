<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta http-equiv="X-UA-Compatible" content="ie=edge">
  <title>OpenStreetMap Haiku</title>
  <link rel="stylesheet" href="../../index.css">
  <link rel="stylesheet" href="../../lib/prism.css">
</head>
<body>
  <a id="logo" href="//satellitestud.io">
    <svg width="150px" viewBox="0 0 183 50" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
      <desc id="logoDesc">Satellite Studio Logo</desc>
        <path d="M34.767,1.980 C33.655,3.539 33,5.441 33,7.5 C33,12.747 37.253,17 42.5,17 C44.558,17 46.464,16.345 48.020,15.233 C49.294,18.233 50,21.534 50,25 C50,38.807 38.807,50 25,50 C11.192,50 0,38.807 0,25 C0,11.192 11.193,0 25,0 C28.466,0 31.767,0.705 34.767,1.980 Z"></path>
        <path d="M77.488,18.616 C79.44,18.616 81.232,19.576 82.256,21.176 L80.144,23.032 C79.344,22.008 78.352,21.56 77.328,21.56 C76.496,21.56 75.728,22.104 75.728,23.16 C75.728,24.312 76.944,24.824 78.608,25.464 C80.784,26.296 83.12,27.256 83.12,30.136 C83.12,32.92 80.976,35.256 77.52,35.256 C74.192,35.256 72.112,32.952 71.28,30.936 L74.096,29.4 C74.736,30.84 75.856,32.312 77.648,32.312 C78.928,32.312 79.824,31.672 79.824,30.2 C79.824,28.792 77.872,28.408 75.984,27.608 C74.128,26.84 72.528,25.656 72.528,23.192 C72.528,20.696 74.576,18.616 77.488,18.616 Z M85.68,30.36 C85.68,27.032 88.528,25.08 92.656,25.08 L95.44,25.08 L95.44,24.376 C95.44,22.36 94,21.56 92.304,21.56 C90.992,21.56 89.84,22.264 89.296,23.704 L86.256,23.064 C86.928,20.344 89.232,18.616 92.336,18.616 C96.08,18.616 98.768,20.248 98.768,24.984 L98.768,35 L95.952,35 L95.632,32.888 C94.576,34.36 92.912,35.256 90.64,35.256 C87.952,35.256 85.68,33.72 85.68,30.36 Z M89.2,30.36 C89.2,31.448 89.808,32.312 91.216,32.312 C93.264,32.312 95.44,31 95.44,28.216 L95.44,27.864 L92.528,27.864 C90.48,27.864 89.2,28.824 89.2,30.36 Z M101.296,21.816 L101.296,18.872 L103.984,18.872 L103.984,14.424 L107.312,12.344 L107.312,18.872 L111.504,18.872 L111.504,21.816 L107.312,21.816 L107.312,29.688 C107.312,31.512 107.984,32.312 109.456,32.312 C110.032,32.312 110.416,32.216 110.992,31.864 L111.856,34.68 C110.992,35.096 110.16,35.256 109.264,35.256 C106.224,35.256 103.984,33.464 103.984,29.496 L103.984,21.816 L101.296,21.816 Z M121.648,21.56 C119.44,21.56 118.064,23.064 117.712,25.08 L125.552,25.08 C125.264,23.288 124.048,21.56 121.648,21.56 Z M129.072,26.424 L129.072,27.864 L117.648,27.864 C117.648,30.232 119.024,32.312 121.648,32.312 C123.376,32.312 125.04,31.352 125.872,29.592 L128.72,30.712 C127.152,33.752 125.328,35.256 121.648,35.256 C116.336,35.256 114.128,30.776 114.128,26.936 C114.128,23.096 116.336,18.616 121.648,18.616 C126.8,18.616 129.072,22.808 129.072,26.424 Z M132.688,12.344 L136.016,12.344 L136.016,35 L132.688,35 L132.688,12.344 Z M140.368,12.344 L143.696,12.344 L143.696,35 L140.368,35 L140.368,12.344 Z M147.248,14.328 C147.248,13.048 148.24,11.992 149.552,11.992 C150.864,11.992 151.856,13.048 151.856,14.328 C151.856,15.608 150.864,16.6 149.552,16.6 C148.24,16.6 147.248,15.608 147.248,14.328 Z M147.888,18.872 L151.216,18.872 L151.216,35 L147.888,35 L147.888,18.872 Z M154.576,21.816 L154.576,18.872 L157.264,18.872 L157.264,14.424 L160.592,12.344 L160.592,18.872 L164.784,18.872 L164.784,21.816 L160.592,21.816 L160.592,29.688 C160.592,31.512 161.264,32.312 162.736,32.312 C163.312,32.312 163.696,32.216 164.272,31.864 L165.136,34.68 C164.272,35.096 163.44,35.256 162.544,35.256 C159.504,35.256 157.264,33.464 157.264,29.496 L157.264,21.816 L154.576,21.816 Z M174.928,21.56 C172.72,21.56 171.344,23.064 170.992,25.08 L178.832,25.08 C178.544,23.288 177.328,21.56 174.928,21.56 Z M182.352,26.424 L182.352,27.864 L170.928,27.864 C170.928,30.232 172.304,32.312 174.928,32.312 C176.656,32.312 178.32,31.352 179.152,29.592 L182,30.712 C180.432,33.752 178.608,35.256 174.928,35.256 C169.616,35.256 167.408,30.776 167.408,26.936 C167.408,23.096 169.616,18.616 174.928,18.616 C180.08,18.616 182.352,22.808 182.352,26.424 Z"></path>
    </svg>
  </a>

  <article>

    <h1>OpenStreetMap Haiku:<br>Using OSM and Overpass for generative poetry</h1>

    <cite>
      Full bellies at Bombay Lounge<br>
      Looking at you from the 4th floor<br>
      Is it too early for a beer?
    </cite>

    <p>
      A bit of random poetry about some corner of London, generated at 11am today. About the same place, looking around, one could also write:
    </p>

    <cite>
      A couple getting a loan<br>
      Yawns in the classroom<br>
      A train underneath
    </cite>

    <p>
      Or maybe, a mile from there:
    </p>

    <cite>
      On the water’s surface<br>
      Going to work<br>
      Flipping burgers
    </cite>

    <figure>
      <video autoplay loop muted playsinline class="medium">
        <source src="osm-haiku.webm" type="video/webm">
      </video>
    </figure>


    <p>
      And so on.
    </p>

    <hr />

    <p>
      Here's what's happening: we automated making haikus about places. Looking at every identifiable object from the surroundings of a point, we can generate a poem about any place in the world. The result is sometimes fun. Often weird. Most of the time, rather terrible. Probably horrifying for haiku purists (sorry). Go ahead and <a href="http://satellitestud.io/osm-haiku/app/">give it a try</a>.
    </p>

    <p>
      Those text collages are assembled using information about the place, taken from OpenStreetMap. As we all know now, “OpenStreetMap is not a map®” - it’s a big database. A database of all the things in the world. In fact, one can browse the list of <a href="https://wiki.openstreetmap.org/wiki/Map_Features">all OSM tags on the OSM wiki</a> and observe the following fact: this is nothing less than an attempt at methodically <b>classifying our reality</b>. So yep, it's a pretty long wiki page.
    </p>

    TODO capture

    <p>
      So in our little project, we take advantage of that crazy thing by matching OSM tags with badly written verses.<br>
      If a supermarket is close to the map center, (ie it has a tag <code>shop=supermarket</code>), we would randomly yield one of: ‘Salad cabbage and carrots’, ‘The cashier’s bored’, ‘A lonely aisle’, ‘Under the neon’, etc.<br>
      A swimming pool (tag <code>leisure=swimming_pool</code>): ‘Smells of chlorine’.<br>
      A garage (tag <code>building=garage</code>): ‘In the garage where I belong’ (shameless Weezer fan here).<br>
      A coffee shop named ‘Grey House’ (tags <code>amenity=cafe</code> and <code>name=‘Grey House’</code>: “Fresh coffee from Grey House”.<br>
      And so on.
    </p>

    TODO environmental

    <p>
      That set of verses is easily extendable - <a href="https://github.com/satellitestudio/osm-haiku/edit/master/app/lines.en.js">have a look and add yours :)</a>
    </p>

    <hr />

    <p>
      This is made possible by using an API for each question we want to ask about a given place:
      <ul>
        <li>Where are we?: <b>Mapbox Places</b></li>
        <li>What time is it? : <b>TimeZoneDB</b></li>
        <li>What's the current weather? : <b>OpenWeatherMap</b></li>
        <li><b>But most importantly, what's here?: the Overpass API</b></li>
      </ul>
    </p>

    <p>
      Overpass is our gateway to tap into the incredible richness of OpenStreetMap, as seen in, you know, that 2 kilometers long wiki page listing all the tags.
    </p>

    <figure>
      <img class="medium" src="carpet-hanger.png">
      <figcaption>
        Even carpet hangers have their tag
      </figcaption>
    </figure>


    <h2>
      An OpenStreetMap refresher
    </h2>

    <p>
      OpenStreetMap can be a bit overwhelming at first. Not only it's a lot of data, but the software ecosystem that surrounds it is complex. So, the best place to start is there: <a href="http://openstreetmap.org">openstreetmap.org</a>. Thank you, captain obvious - now the thing is, that site is not very good at being a useful map, but it's excellent for what it was designed for, which is being an entry point and a debugging tool for OSM data.
    </p>
  
    <figure>
      <video autoplay loop muted playsinline class="medium">
        <source src="query-features.webm" type="video/webm">
      </video>
      <figcaption>Poking at OSM data</figcaption>
    </figure>
  
    <p>
      Using that 'Query features' functionality is akin to what we'll be eventually doing to generate haikus. So far, what you see is a bunch of named objects. Looking further, you'll start noticing that these objects have <b>relationships</b>: a metro station belongs to a portion of a railway, which itself belongs to an entire metro line:
    </p>

    <figure>
      <video autoplay loop muted playsinline class="medium">
        <source src="query-features.webm" type="video/webm">
      </video>
      <figcaption>A node that belongs to a way that belongs to a relation</figcaption>
    </figure>

    <p>
      And so goes the holy trinity of OSM: <b>Nodes, Ways, Relations</b>. A very common pattern being that a "conceptual" object (a metro line, a golf course, a ski resort) represented by a <b>relation</b>, and which does not have its own geometry, holds either a bunch of <b>nodes</b> (a golf hole) or a bunch of <b>ways</b> (a ski piste), which themselves hold nodes to form a line geometry.
    </p>

    <hr />

    <p>
      Here goes the coolest part: any number of tags, of any form, can be added to any of those three types of objects. See for yourself:
    </p>

    <figure>
      <video autoplay loop muted playsinline class="medium">
        <source src="query-features-details.webm" type="video/webm">
      </video>
      <figcaption>Looking for tags</figcaption>
    </figure>

    <p>
      Those tags are always composed of a <code>key=value</code> tuple, and are completely free form: anyone can add any tag they deem useful, there is no schema or spec of any sort. There are <b>conventions</b>, though. In general by way of consensus - see carpet hanger example, which was <a href="https://wiki.openstreetmap.org/wiki/Tag:man_made%3Dcarpet_hanger">approved at some point</a>. In fact there is a <a href="https://lists.openstreetmap.org/pipermail/tagging/">dedicated tagging mailing-list</a>, which is a fascinating place, with questions ranging from <a href="https://lists.openstreetmap.org/pipermail/tagging/2018-March/035405.html">tagging fraction house numbers?</a> and <a href="https://lists.openstreetmap.org/pipermail/tagging/2019-July/046358.html">choosing between bbq=yes or barbecue_grill=yes</a> to <em>much</em> more complicated geopolitical issues such as tagging <a href="https://lists.openstreetmap.org/pipermail/talk/2018-October/081553.html">disputed boundaries in Crimea</a>.
    </p>

    <hr />

    <p>
      This is very nice, but how do we programatically access this data? There is such a thing as <a href="https://wiki.openstreetmap.org/wiki/API_v0.6">an OpenStreetMap API</a>, but don't be fooled: the same way osm.org is not intended to be consumer facing, the OSM API is mostly designed to be used by editing software, as in, a lot of its endpoints are meant for writing, and reading operations are awkward for simple use cases.
    </p>

    <h2>
      Taming Overpass
    </h2>

    <p>
      Overpass is as read-only API to OpenStreetMap, which uses it's own query language, aptly named Overpass QL, and has it's own sandbox located at <a href="http://overpass-turbo.eu/">overpass-turbo.eu</a>.
    </p>

    <p>
      Overpass is fantastic and weird and powerful and scary. Its query language is very terse, very OSM-specific, very powerful, and can be *a bit* putting off, especially for those of us not entirely fluent in <a href="https://en.wikipedia.org/wiki/Malbolge">Malbolge</a>. So, young and full of ideals, you head off to Overpass Turbo, which has a nifty "wizard" function. Except it's a "wizard", in the sense that it does black magic somewhow and leaves you, poor Muggle, quite out of it. It's more like a Saroumane kind of wizard really (and in his bad days).
    </p>

    <p>
      My recommandation is to start here: go to <a href="http://overpass-turbo.eu/s/KIp">Overpass Turbo and find the Eiffel Tower, in Paris</a> (ouh lala), and copy paste the following:
    </p>

    TODO
    Node only first
    node trees
    kebabs



    <pre>
      <code class="language-js">
          node[natural=tree]({{bbox}});
          out;
      </code>
    </pre>
    
    <p>
      It says 'retrieve all the nodes (<code>node</code>) that represent trees (<code>[natural=tree]</code>) in the currently visible map area (<code>({{bbox}})</code>). Then give us the result of that query. Check out the nodes in the map, they have extra information such as circumference, height, and even genus of the trees!
    </p>
    

    <pre>
      <code class="language-js">
        [out:json];
        node[cuisine=kebab]({{bbox}});
        out body;
      </code>
    </pre>


    <p>
      Bla bla ready for the wizard
    </p>

    <figure>
      <img class="medium" src="wizard.png">
      <figcaption>
        The wizard-generated query, tore apart
      </figcaption>
    </figure>



    <p>
      Bla bla the Haiku Overpass QL query
    </p>
  

    <pre>
        <code class="language-js">
            const ql = `
              [out:json][timeout:5];

              (
                nwr[~"."~"."](around:${radius},${lat},${lng});
              <;);out tags ${center};

              (
                way[~"landuse|landcover|natural"~"."](around:${radius * 4},${lat},${lng});
              );out tags ${center};

              is_in(${lat},${lng})->.a;
              relation(pivot.a);
              out tags ${center};
            `
        </code>
      </pre>


    <h2>
      Artistic purpose
    </h2>

    <p>
      TODO: Katsuda, subjective view, hommage to haiku etc
    </p>

    <p>

    </p>

    <h2>
      Isn't that kind of pointless?
    </h2>

    <figure>
      <img class="medium" src="jurassic-park.jpg" alt="You were so preoccuppied with whether or not you could - you didn't stop to think if you should">
      <figcaption>
          You were so preoccuppied with whether or not you could - you didn't stop to think if you should.
      </figcaption>
    </figure>

    <p>
      Sure.
    </p>

    <p>
      But I also want to say: "you were so preoccupied by your dashboards that you didn't stop to think whether you were having fun".
    </p>

    <p>
        In this era of big data, analytics and dashboards, maybe there’s room for a little bit of subjectivity, sensation, and anecdote.  In line with small data manifesto. Maybe OpenStreetMap Haiku has more appeal to some than 4 billion nodes. 
        This is nothing more than an experiment, but this is in line with what we try to inject in our <a href="http://satellitestud.io">work</a>: more empathy, more beauty and yes, why not, more poetry. 
    </p>


    <h2>Hey what about neural nets ?</h2>

    <p>
      Yes, that would be the next step. Training a neural net trained on a database of haikus or poetry and force themes according to OSM tags. <a href="https://www.newscientist.com/article/2140014-neural-network-poetry-is-so-bad-we-think-its-written-by-humans/">Neural net poetry is not a new idea, in fact</a>.
    </p>

    <p>
      And training neural nets on text datasets can yield hilarious results, as seen in the work of <a href="https://aiweirdness.com/">Janelle Shane</a> (see <a href="https://aiweirdness.com/post/160407271482/metal-band-names-invented-by-neural-network">metal band names</a>, <a href="https://aiweirdness.com/post/140219420017/the-silicon-gourmet-training-a-neural-network-to">recipes</a>, <a href="https://aiweirdness.com/post/159132506927/in-which-a-neural-network-learns-to-tell">knock-knock jokes</a>
  </p>
     
  <p>
    TODO
  </p>

  <p>
        We like our low-tech haiku generator as it is for now. But stay tuned :)
    </p>


  </article>
  <script src="../../lib/prism.js"></script>
  <script src="../../index.js"></script>
</body>
</html>